<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Kursai.maui.Views.AddKursai"
             Title="Add Course"
             BackgroundColor="{StaticResource Background}">
    <ScrollView>
        <VerticalStackLayout Padding="24,32" Spacing="24">
            
            <!-- Header -->
            <VerticalStackLayout Spacing="8">
                <Label Text="Create New Course"
                       FontSize="32"
                       FontFamily="OpenSansSemibold"
                       TextColor="{StaticResource TextPrimary}"
                       HorizontalOptions="Center"/>
                <Label Text="Share your knowledge with students"
                       FontSize="16"
                       TextColor="{StaticResource TextSecondary}"
                       HorizontalOptions="Center"/>
            </VerticalStackLayout>

            <!-- Course Form -->
            <VerticalStackLayout Spacing="20">

                <!-- Course Title -->
                <VerticalStackLayout Spacing="8">
                    <Label Text="Course Title"
                           FontSize="14"
                           FontFamily="OpenSansSemibold"
                           TextColor="{StaticResource TextSecondary}"/>
                    <Frame Padding="16,0" 
                           CornerRadius="12" 
                           HasShadow="False"
                           BorderColor="{StaticResource Border}"
                           BackgroundColor="{StaticResource Surface}">
                        <Entry Text="{Binding CourseTitle}"
                               Placeholder="Enter course title"
                               PlaceholderColor="{StaticResource TextTertiary}"
                               TextColor="{StaticResource TextPrimary}"
                               BackgroundColor="Transparent"
                               FontSize="16"
                               HeightRequest="52"/>
                    </Frame>
                </VerticalStackLayout>

                <!-- Description -->
                <VerticalStackLayout Spacing="8">
                    <Label Text="Description"
                           FontSize="14"
                           FontFamily="OpenSansSemibold"
                           TextColor="{StaticResource TextSecondary}"/>
                    <Frame Padding="16" 
                           CornerRadius="12" 
                           HasShadow="False"
                           BorderColor="{StaticResource Border}"
                           BackgroundColor="{StaticResource Surface}">
                        <Editor Text="{Binding Description}"
                                Placeholder="Describe your course..."
                                PlaceholderColor="{StaticResource TextTertiary}"
                                TextColor="{StaticResource TextPrimary}"
                                BackgroundColor="Transparent"
                                FontSize="16"
                                HeightRequest="120"
                                AutoSize="TextChanges"/>
                    </Frame>
                </VerticalStackLayout>

                <!-- Category Picker -->
                <VerticalStackLayout Spacing="8">
                    <Label Text="Category"
                           FontSize="14"
                           FontFamily="OpenSansSemibold"
                           TextColor="{StaticResource TextSecondary}"/>
                    <Frame Padding="16,0" 
                           CornerRadius="12" 
                           HasShadow="False"
                           BorderColor="{StaticResource Border}"
                           BackgroundColor="{StaticResource Surface}">
                        <Picker ItemsSource="{Binding Categories}"
                                SelectedItem="{Binding SelectedCategory}"
                                Title="Select a category"
                                TextColor="{StaticResource TextPrimary}"
                                TitleColor="{StaticResource TextTertiary}"
                                BackgroundColor="Transparent"
                                FontSize="16"
                                HeightRequest="52"
                                VerticalOptions="Center"/>
                    </Frame>
                </VerticalStackLayout>

                <!-- Price -->
                <VerticalStackLayout Spacing="8">
                    <Label Text="Price (USD)"
                           FontSize="14"
                           FontFamily="OpenSansSemibold"
                           TextColor="{StaticResource TextSecondary}"/>
                    <Frame Padding="16,0" 
                           CornerRadius="12" 
                           HasShadow="False"
                           BorderColor="{StaticResource Border}"
                           BackgroundColor="{StaticResource Surface}">
                        <Grid ColumnDefinitions="Auto,*">
                            <Label Grid.Column="0"
                                   Text="$"
                                   FontSize="20"
                                   FontFamily="OpenSansSemibold"
                                   TextColor="{StaticResource Primary}"
                                   VerticalOptions="Center"
                                   Margin="0,0,8,0"/>
                            <Entry Grid.Column="1"
                                   Text="{Binding Price}"
                                   Placeholder="0.00"
                                   PlaceholderColor="{StaticResource TextTertiary}"
                                   TextColor="{StaticResource TextPrimary}"
                                   BackgroundColor="Transparent"
                                   Keyboard="Numeric"
                                   FontSize="16"
                                   HeightRequest="52"
                                   VerticalOptions="Center"/>
                        </Grid>
                    </Frame>
                </VerticalStackLayout>

                <!-- File Attachment -->
                <VerticalStackLayout Spacing="8">
                    <Label Text="Course Material (Optional - Testing)"
                           FontSize="14"
                           FontFamily="OpenSansSemibold"
                           TextColor="{StaticResource TextSecondary}"/>
                    <Label Text="Attach a video or PDF file (max 50MB)"
                           FontSize="12"
                           TextColor="{StaticResource TextTertiary}"
                           Margin="0,-4,0,0"/>
                    
                    <!-- Pick File Button -->
                    <Button Text="ðŸ“Ž Select File"
                            Command="{Binding PickFileCommand}"
                            Style="{StaticResource SecondaryButton}"
                            HeightRequest="52"
                            IsVisible="{Binding HasAttachment, Converter={StaticResource InvertedBoolConverter}}"/>
                    
                    <!-- Selected File Display -->
                    <Frame Padding="16" 
                           CornerRadius="12" 
                           HasShadow="False"
                           BorderColor="{StaticResource Primary}"
                           BackgroundColor="{StaticResource Surface}"
                           IsVisible="{Binding HasAttachment}">
                        <Grid ColumnDefinitions="*,Auto">
                            <VerticalStackLayout Grid.Column="0" Spacing="4">
                                <Label Text="ðŸ“„ Attached File"
                                       FontSize="12"
                                       TextColor="{StaticResource TextSecondary}"/>
                                <Label Text="{Binding AttachmentFileName}"
                                       FontSize="16"
                                       FontFamily="OpenSansSemibold"
                                       TextColor="{StaticResource TextPrimary}"
                                       LineBreakMode="TailTruncation"/>
                                <Label Text="{Binding AttachmentFileType}"
                                       FontSize="12"
                                       TextColor="{StaticResource TextTertiary}"/>
                            </VerticalStackLayout>
                            <Button Grid.Column="1"
                                    Text="âœ•"
                                    Command="{Binding RemoveFileCommand}"
                                    BackgroundColor="Transparent"
                                    TextColor="{StaticResource Error}"
                                    FontSize="24"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"
                                    Padding="0"
                                    VerticalOptions="Center"/>
                        </Grid>
                    </Frame>
                </VerticalStackLayout>

            </VerticalStackLayout>

            <!-- Action Buttons -->
            <VerticalStackLayout Spacing="12" Margin="0,16,0,0">
                
                <!-- Save Button -->
                <Button Text="Create Course"
                        Command="{Binding SaveCommand}"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="{StaticResource TextOnPrimary}"
                        FontFamily="OpenSansSemibold"
                        FontSize="18"
                        HeightRequest="56"
                        CornerRadius="16"/>

                <!-- Cancel Button -->
                <Button Text="Cancel"
                        Command="{Binding CancelCommand}"
                        Style="{StaticResource SecondaryButton}"
                        HeightRequest="56"/>
            </VerticalStackLayout>

            <!-- Activity Indicator -->
            <ActivityIndicator IsRunning="{Binding IsBusy}"
                              IsVisible="{Binding IsBusy}"
                              Color="{StaticResource Primary}"
                              WidthRequest="48"
                              HeightRequest="48"
                              HorizontalOptions="Center"
                              Margin="0,16"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>